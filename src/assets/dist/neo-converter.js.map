{"version":3,"file":"neo-converter.js","mappings":"mBACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CAAM,ECLdF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDR,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,ICAlF,MAAM,EAA+BI,O,aCArC,MAAM,EAA+BC,M,aCArC,MAAM,EAA+BC,Q,aCIrC,MAAMC,EAAaC,IAAE,SACfC,EAAWD,IAAE,yBAEnB,GAAyB,qBAArBD,EAAWG,OAAgCD,EAASE,OAAS,EAAG,CAClE,MAAMC,EAAQP,IAAAA,GAASQ,aACjBC,EAAcF,EAAMG,KAAK,wBAC/B,IAAIC,EAAWR,IAAE,0BACbS,EAAWT,IAAE,2BACbU,GAAU,EAEd,MAAMC,EAAcC,IAClBF,IAAYE,EAEZJ,EAASK,YAAY,YAAaH,GAClCJ,EAAYO,YAAY,YAAaH,GAEjCA,EACFN,EAAMU,IAAI,cAEVV,EAAMW,GAAG,cAAcC,GAAKA,EAAEC,kBAChC,EAGIC,EAAUA,KACdP,GAAY,GAEZF,EAASU,YAAY,UAErBtB,IAAAA,kBAAwB,mCAAoC,CAAEuB,QAASnB,EAASC,QAAS,CAACmB,EAAUC,KAClG,GAAID,EAASE,QAEX1B,IAAAA,GAAS2B,eAAe1B,IAAAA,KAAc,gBAEtC2B,OAAOC,SAASC,cAMhB,GAJAhB,GAAY,GAEZd,IAAAA,GAAS+B,aAAa/B,IAAAA,EAAQ,MAAO,0CAEjCwB,EAASQ,QAAUR,EAASQ,OAAO1B,OAAS,EAC9C,IAAK,MAAM2B,KAAST,EAASQ,OAC3BhC,IAAAA,GAAS+B,aAAaE,EAG5B,GACA,EAGEC,EAAYA,KAChB,MAAMC,EAAkBhC,IAAE,wBAEtBgC,EAAgBzB,KAAK,sBAAsBJ,OAAS,IAIxD6B,EAAgBC,QAAQ,0HAADC,OAINrC,IAAAA,EAAQ,MAAO,oBAAmB,uDAAAqC,OACZrC,IAAAA,EAAQ,MAAO,sHAAqH,2JAAAqC,OAGvFrC,IAAAA,EAAQ,MAAO,WAAU,qIAAAqC,OAGlFrC,IAAAA,EAAQ,MAAO,iEAAgE,yDAM1GW,EAAWR,IAAE,0BACbS,EAAWT,IAAE,2BAEbQ,EAASO,GAAG,SAASC,IACnBA,EAAEC,iBAEEP,GAAWe,OAAOU,QAAQtC,IAAAA,EAAQ,MAAO,+FAC3CqB,GACF,IACA,EAGqB,IAAIO,OAAOW,iBAAiBL,GACpCM,QAAQC,SAASC,eAAe,YAAa,CAAEC,WAAW,EAAMC,SAAS,GAC5F,C","sources":["webpack://craft-neo/webpack/bootstrap","webpack://craft-neo/webpack/runtime/compat get default export","webpack://craft-neo/webpack/runtime/define property getters","webpack://craft-neo/webpack/runtime/hasOwnProperty shorthand","webpack://craft-neo/external var \"jQuery\"","webpack://craft-neo/external var \"Craft\"","webpack://craft-neo/external var \"Garnish\"","webpack://craft-neo/./src/assets/src/converter.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = jQuery;","const __WEBPACK_NAMESPACE_OBJECT__ = Craft;","const __WEBPACK_NAMESPACE_OBJECT__ = Garnish;","import $ from 'jquery'\nimport Craft from 'craft'\nimport Garnish from 'garnish'\n\nconst $fieldType = $('#type')\nconst $fieldId = $('input[name=\"fieldId\"]')\n\nif ($fieldType.val() === 'benf\\\\neo\\\\Field' && $fieldId.length > 0) {\n  const $form = Craft.cp.$primaryForm\n  const $formButton = $form.find('input[type=\"submit\"]')\n  let $convert = $('#Matrix-convert_button')\n  let $spinner = $('#Matrix-convert_spinner')\n  let enabled = true\n\n  const toggleState = state => {\n    enabled = !!state\n\n    $convert.toggleClass('disabled', !enabled)\n    $formButton.toggleClass('disabled', !enabled)\n\n    if (enabled) {\n      $form.off('submit.neo')\n    } else {\n      $form.on('submit.neo', e => e.preventDefault())\n    }\n  }\n\n  const perform = () => {\n    toggleState(false)\n\n    $spinner.removeClass('hidden')\n\n    Craft.postActionRequest('neo/conversion/convert-to-matrix', { fieldId: $fieldId.val() }, (response, textStatus) => {\n      if (response.success) {\n        // Prevent the \"Do you want to reload this site?\" prompt from showing\n        Craft.cp.removeListener(Garnish.$win, 'beforeunload')\n\n        window.location.reload()\n      } else {\n        toggleState(true)\n\n        Craft.cp.displayError(Craft.t('neo', 'Could not convert Neo field to Matrix'))\n\n        if (response.errors && response.errors.length > 0) {\n          for (const error of response.errors) {\n            Craft.cp.displayError(error)\n          }\n        }\n      }\n    })\n  }\n\n  const applyHtml = () => {\n    const $matrixSettings = $('#craft-fields-Matrix')\n\n    if ($matrixSettings.find('#conversion-prompt').length > 0) {\n      return\n    }\n\n    $matrixSettings.prepend(`\n      <div id=\"conversion-prompt\">\n        <div class=\"field\">\n          <div class=\"heading\">\n            <label>${Craft.t('neo', 'Convert from Neo')}</label>\n            <div class=\"instructions\"><p>${Craft.t('neo', 'This field is currently of the Neo type. You may automatically convert it to Matrix along with all of its content.')}</p></div>\n          </div>\n          <div class=\"input ltr\">\n            <input id=\"Matrix-convert_button\" type=\"button\" class=\"btn submit\" value=\"${Craft.t('neo', 'Convert')}\">\n            <span id=\"Matrix-convert_spinner\" class=\"spinner hidden\"></span>\n          </div>\n          <p class=\"warning\">${Craft.t('neo', 'By converting to Matrix, structural information will be lost.')}</p>\n        </div>\n      </div>\n      <hr>\n    `)\n\n    $convert = $('#Matrix-convert_button')\n    $spinner = $('#Matrix-convert_spinner')\n\n    $convert.on('click', e => {\n      e.preventDefault()\n\n      if (enabled && window.confirm(Craft.t('neo', 'Are you sure? This is a one way operation. You cannot undo conversion from Neo to Matrix.'))) {\n        perform()\n      }\n    })\n  }\n\n  const settingsObserver = new window.MutationObserver(applyHtml)\n  settingsObserver.observe(document.getElementById('settings'), { childList: true, subtree: true })\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","jQuery","Craft","Garnish","$fieldType","$","$fieldId","val","length","$form","$primaryForm","$formButton","find","$convert","$spinner","enabled","toggleState","state","toggleClass","off","on","e","preventDefault","perform","removeClass","fieldId","response","textStatus","success","removeListener","window","location","reload","displayError","errors","error","applyHtml","$matrixSettings","prepend","concat","confirm","MutationObserver","observe","document","getElementById","childList","subtree"],"sourceRoot":""}